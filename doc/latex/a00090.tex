\hypertarget{a00090}{}\section{E\+:/knet-\/git/knet/knet/stream.c 文件参考}
\label{a00090}\index{E\+:/knet-\/git/knet/knet/stream.\+c@{E\+:/knet-\/git/knet/knet/stream.\+c}}
{\ttfamily \#include $<$stdarg.\+h$>$}\\*
{\ttfamily \#include \char`\"{}stream.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}config.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}channel\+\_\+ref.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}ringbuffer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}buffer.\+h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}misc.\+h\char`\"{}}\\*
\subsection*{结构体}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{a00034}{\+\_\+stream\+\_\+t}
\end{DoxyCompactItemize}
\subsection*{函数}
\begin{DoxyCompactItemize}
\item 
\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$ \hyperlink{a00090_a3d96722aed377b124baa5a38a4b3fa54_a3d96722aed377b124baa5a38a4b3fa54}{stream\+\_\+create} (\hyperlink{a00050_a151271c9d188ef28d4d24bb81dcc1263_a151271c9d188ef28d4d24bb81dcc1263}{channel\+\_\+ref\+\_\+t} $\ast$channel\+\_\+ref)
\item 
void \hyperlink{a00090_ac57e177168fe8e441793c4345f5745c3_ac57e177168fe8e441793c4345f5745c3}{stream\+\_\+destroy} (\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$stream)
\item 
int \hyperlink{a00106_ga6e109b2dc520782567dc1891af3b945e_ga6e109b2dc520782567dc1891af3b945e}{stream\+\_\+available} (\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$stream)
\begin{DoxyCompactList}\small\item\em 取得数据流内可读字节数 \end{DoxyCompactList}\item 
int \hyperlink{a00106_ga6e01758abf49f8b08cd457f1cb48a954_ga6e01758abf49f8b08cd457f1cb48a954}{stream\+\_\+pop} (\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$stream, void $\ast$buffer, int size)
\begin{DoxyCompactList}\small\item\em 从数据流内读取数据并清除数据 \end{DoxyCompactList}\item 
int \hyperlink{a00106_gaef7f4ca2c201faf5d82a1dad4c8d7814_gaef7f4ca2c201faf5d82a1dad4c8d7814}{stream\+\_\+eat\+\_\+all} (\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$stream)
\begin{DoxyCompactList}\small\item\em 清空数据流 \end{DoxyCompactList}\item 
int \hyperlink{a00106_ga1ab922f8bab979099b3abc3ee54dc59d_ga1ab922f8bab979099b3abc3ee54dc59d}{stream\+\_\+eat} (\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$stream, int size)
\begin{DoxyCompactList}\small\item\em 删除指定长度数据 \end{DoxyCompactList}\item 
int \hyperlink{a00106_gae7e63ef142733eb3aea7401e28bc9a75_gae7e63ef142733eb3aea7401e28bc9a75}{stream\+\_\+push} (\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$stream, const void $\ast$buffer, int size)
\begin{DoxyCompactList}\small\item\em 向数据流内写数据 \end{DoxyCompactList}\item 
int \hyperlink{a00106_ga9631c1d90e0fad04b6ad04ccc5b95808_ga9631c1d90e0fad04b6ad04ccc5b95808}{stream\+\_\+push\+\_\+varg} (\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$stream, const char $\ast$format,...)
\begin{DoxyCompactList}\small\item\em 向数据流写数据，可变参数字符串 \end{DoxyCompactList}\item 
int \hyperlink{a00106_ga380555bf71ee99f6b2bb4f76738d507f_ga380555bf71ee99f6b2bb4f76738d507f}{stream\+\_\+copy} (\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$stream, void $\ast$buffer, int size)
\begin{DoxyCompactList}\small\item\em 从数据流内拷贝数据，但不清除数据流内数据 \end{DoxyCompactList}\item 
int \hyperlink{a00106_gad5336c2b89b6edea5f277d5ebc221e15_gad5336c2b89b6edea5f277d5ebc221e15}{stream\+\_\+push\+\_\+stream} (\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$stream, \hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$target)
\begin{DoxyCompactList}\small\item\em 将stream内数据写入target, 并清除stream内数据 \end{DoxyCompactList}\item 
int \hyperlink{a00106_ga296aea89ba5bec6566e119855df3b18c_ga296aea89ba5bec6566e119855df3b18c}{stream\+\_\+copy\+\_\+stream} (\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$stream, \hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$target)
\begin{DoxyCompactList}\small\item\em 将stream内数据写入target, 但不清除stream内数据 \end{DoxyCompactList}\item 
\hyperlink{a00050_a151271c9d188ef28d4d24bb81dcc1263_a151271c9d188ef28d4d24bb81dcc1263}{channel\+\_\+ref\+\_\+t} $\ast$ \hyperlink{a00106_gab4b3e49d2c44a601e8bb7f568577fae4_gab4b3e49d2c44a601e8bb7f568577fae4}{stream\+\_\+get\+\_\+channel\+\_\+ref} (\hyperlink{a00050_a261dba04f46f5c59a68a05f69f5a65a8_a261dba04f46f5c59a68a05f69f5a65a8}{stream\+\_\+t} $\ast$stream)
\begin{DoxyCompactList}\small\item\em 获取流所属的管道引用 \end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{函数说明}
\hypertarget{a00106_ga6e109b2dc520782567dc1891af3b945e_ga6e109b2dc520782567dc1891af3b945e}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+available@{stream\+\_\+available}}
\index{stream\+\_\+available@{stream\+\_\+available}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+available}]{\setlength{\rightskip}{0pt plus 5cm}int stream\+\_\+available (
\begin{DoxyParamCaption}
\item[{{\bf stream\+\_\+t} $\ast$}]{stream}
\end{DoxyParamCaption}
)}\label{a00106_ga6e109b2dc520782567dc1891af3b945e_ga6e109b2dc520782567dc1891af3b945e}


取得数据流内可读字节数 


\begin{DoxyParams}{参数}
{\em stream} & stream\+\_\+t实例 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
可读字节数 
\end{DoxyReturn}
\hypertarget{a00106_ga380555bf71ee99f6b2bb4f76738d507f_ga380555bf71ee99f6b2bb4f76738d507f}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+copy@{stream\+\_\+copy}}
\index{stream\+\_\+copy@{stream\+\_\+copy}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+copy}]{\setlength{\rightskip}{0pt plus 5cm}int stream\+\_\+copy (
\begin{DoxyParamCaption}
\item[{{\bf stream\+\_\+t} $\ast$}]{stream, }
\item[{void $\ast$}]{buffer, }
\item[{int}]{size}
\end{DoxyParamCaption}
)}\label{a00106_ga380555bf71ee99f6b2bb4f76738d507f_ga380555bf71ee99f6b2bb4f76738d507f}


从数据流内拷贝数据，但不清除数据流内数据 


\begin{DoxyParams}{参数}
{\em stream} & stream\+\_\+t实例 \\
\hline
{\em buffer} & 缓冲区 \\
\hline
{\em size} & 缓冲区大小 \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em error\+\_\+ok} & 成功 \\
\hline
{\em 其他} & 失败 \\
\hline
\end{DoxyRetVals}
\hypertarget{a00106_ga296aea89ba5bec6566e119855df3b18c_ga296aea89ba5bec6566e119855df3b18c}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+copy\+\_\+stream@{stream\+\_\+copy\+\_\+stream}}
\index{stream\+\_\+copy\+\_\+stream@{stream\+\_\+copy\+\_\+stream}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+copy\+\_\+stream}]{\setlength{\rightskip}{0pt plus 5cm}int stream\+\_\+copy\+\_\+stream (
\begin{DoxyParamCaption}
\item[{{\bf stream\+\_\+t} $\ast$}]{stream, }
\item[{{\bf stream\+\_\+t} $\ast$}]{target}
\end{DoxyParamCaption}
)}\label{a00106_ga296aea89ba5bec6566e119855df3b18c_ga296aea89ba5bec6566e119855df3b18c}


将stream内数据写入target, 但不清除stream内数据 


\begin{DoxyParams}{参数}
{\em stream} & stream\+\_\+t实例 \\
\hline
{\em target} & stream\+\_\+t实例 \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em error\+\_\+ok} & 成功 \\
\hline
{\em 其他} & 失败 \\
\hline
\end{DoxyRetVals}
\hypertarget{a00090_a3d96722aed377b124baa5a38a4b3fa54_a3d96722aed377b124baa5a38a4b3fa54}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+create@{stream\+\_\+create}}
\index{stream\+\_\+create@{stream\+\_\+create}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+create}]{\setlength{\rightskip}{0pt plus 5cm}{\bf stream\+\_\+t}$\ast$ stream\+\_\+create (
\begin{DoxyParamCaption}
\item[{{\bf channel\+\_\+ref\+\_\+t} $\ast$}]{channel\+\_\+ref}
\end{DoxyParamCaption}
)}\label{a00090_a3d96722aed377b124baa5a38a4b3fa54_a3d96722aed377b124baa5a38a4b3fa54}
\hypertarget{a00090_ac57e177168fe8e441793c4345f5745c3_ac57e177168fe8e441793c4345f5745c3}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+destroy@{stream\+\_\+destroy}}
\index{stream\+\_\+destroy@{stream\+\_\+destroy}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+destroy}]{\setlength{\rightskip}{0pt plus 5cm}void stream\+\_\+destroy (
\begin{DoxyParamCaption}
\item[{{\bf stream\+\_\+t} $\ast$}]{stream}
\end{DoxyParamCaption}
)}\label{a00090_ac57e177168fe8e441793c4345f5745c3_ac57e177168fe8e441793c4345f5745c3}
\hypertarget{a00106_ga1ab922f8bab979099b3abc3ee54dc59d_ga1ab922f8bab979099b3abc3ee54dc59d}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+eat@{stream\+\_\+eat}}
\index{stream\+\_\+eat@{stream\+\_\+eat}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+eat}]{\setlength{\rightskip}{0pt plus 5cm}int stream\+\_\+eat (
\begin{DoxyParamCaption}
\item[{{\bf stream\+\_\+t} $\ast$}]{stream, }
\item[{int}]{size}
\end{DoxyParamCaption}
)}\label{a00106_ga1ab922f8bab979099b3abc3ee54dc59d_ga1ab922f8bab979099b3abc3ee54dc59d}


删除指定长度数据 


\begin{DoxyParams}{参数}
{\em stream} & stream\+\_\+t实例 \\
\hline
{\em size} & 需要删除的长度 \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em error\+\_\+ok} & 成功 \\
\hline
{\em 其他} & 失败 \\
\hline
\end{DoxyRetVals}
\hypertarget{a00106_gaef7f4ca2c201faf5d82a1dad4c8d7814_gaef7f4ca2c201faf5d82a1dad4c8d7814}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+eat\+\_\+all@{stream\+\_\+eat\+\_\+all}}
\index{stream\+\_\+eat\+\_\+all@{stream\+\_\+eat\+\_\+all}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+eat\+\_\+all}]{\setlength{\rightskip}{0pt plus 5cm}int stream\+\_\+eat\+\_\+all (
\begin{DoxyParamCaption}
\item[{{\bf stream\+\_\+t} $\ast$}]{stream}
\end{DoxyParamCaption}
)}\label{a00106_gaef7f4ca2c201faf5d82a1dad4c8d7814_gaef7f4ca2c201faf5d82a1dad4c8d7814}


清空数据流 


\begin{DoxyParams}{参数}
{\em stream} & stream\+\_\+t实例 \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em error\+\_\+ok} & 成功 \\
\hline
{\em 其他} & 失败 \\
\hline
\end{DoxyRetVals}
\hypertarget{a00106_gab4b3e49d2c44a601e8bb7f568577fae4_gab4b3e49d2c44a601e8bb7f568577fae4}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+get\+\_\+channel\+\_\+ref@{stream\+\_\+get\+\_\+channel\+\_\+ref}}
\index{stream\+\_\+get\+\_\+channel\+\_\+ref@{stream\+\_\+get\+\_\+channel\+\_\+ref}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+get\+\_\+channel\+\_\+ref}]{\setlength{\rightskip}{0pt plus 5cm}{\bf channel\+\_\+ref\+\_\+t}$\ast$ stream\+\_\+get\+\_\+channel\+\_\+ref (
\begin{DoxyParamCaption}
\item[{{\bf stream\+\_\+t} $\ast$}]{stream}
\end{DoxyParamCaption}
)}\label{a00106_gab4b3e49d2c44a601e8bb7f568577fae4_gab4b3e49d2c44a601e8bb7f568577fae4}


获取流所属的管道引用 


\begin{DoxyParams}{参数}
{\em stream} & stream\+\_\+t实例 \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{返回}
channel\+\_\+ref\+\_\+t实例 
\end{DoxyReturn}
\hypertarget{a00106_ga6e01758abf49f8b08cd457f1cb48a954_ga6e01758abf49f8b08cd457f1cb48a954}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+pop@{stream\+\_\+pop}}
\index{stream\+\_\+pop@{stream\+\_\+pop}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+pop}]{\setlength{\rightskip}{0pt plus 5cm}int stream\+\_\+pop (
\begin{DoxyParamCaption}
\item[{{\bf stream\+\_\+t} $\ast$}]{stream, }
\item[{void $\ast$}]{buffer, }
\item[{int}]{size}
\end{DoxyParamCaption}
)}\label{a00106_ga6e01758abf49f8b08cd457f1cb48a954_ga6e01758abf49f8b08cd457f1cb48a954}


从数据流内读取数据并清除数据 


\begin{DoxyParams}{参数}
{\em stream} & stream\+\_\+t实例 \\
\hline
{\em buffer} & 缓冲区 \\
\hline
{\em size} & 缓冲区大小 \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em error\+\_\+ok} & 成功 \\
\hline
{\em 其他} & 失败 \\
\hline
\end{DoxyRetVals}
\hypertarget{a00106_gae7e63ef142733eb3aea7401e28bc9a75_gae7e63ef142733eb3aea7401e28bc9a75}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+push@{stream\+\_\+push}}
\index{stream\+\_\+push@{stream\+\_\+push}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+push}]{\setlength{\rightskip}{0pt plus 5cm}int stream\+\_\+push (
\begin{DoxyParamCaption}
\item[{{\bf stream\+\_\+t} $\ast$}]{stream, }
\item[{const void $\ast$}]{buffer, }
\item[{int}]{size}
\end{DoxyParamCaption}
)}\label{a00106_gae7e63ef142733eb3aea7401e28bc9a75_gae7e63ef142733eb3aea7401e28bc9a75}


向数据流内写数据 


\begin{DoxyParams}{参数}
{\em stream} & stream\+\_\+t实例 \\
\hline
{\em buffer} & 缓冲区 \\
\hline
{\em size} & 缓冲区大小 \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em error\+\_\+ok} & 成功 \\
\hline
{\em 其他} & 失败 \\
\hline
\end{DoxyRetVals}
\hypertarget{a00106_gad5336c2b89b6edea5f277d5ebc221e15_gad5336c2b89b6edea5f277d5ebc221e15}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+push\+\_\+stream@{stream\+\_\+push\+\_\+stream}}
\index{stream\+\_\+push\+\_\+stream@{stream\+\_\+push\+\_\+stream}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+push\+\_\+stream}]{\setlength{\rightskip}{0pt plus 5cm}int stream\+\_\+push\+\_\+stream (
\begin{DoxyParamCaption}
\item[{{\bf stream\+\_\+t} $\ast$}]{stream, }
\item[{{\bf stream\+\_\+t} $\ast$}]{target}
\end{DoxyParamCaption}
)}\label{a00106_gad5336c2b89b6edea5f277d5ebc221e15_gad5336c2b89b6edea5f277d5ebc221e15}


将stream内数据写入target, 并清除stream内数据 


\begin{DoxyParams}{参数}
{\em stream} & stream\+\_\+t实例 \\
\hline
{\em target} & stream\+\_\+t实例 \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em error\+\_\+ok} & 成功 \\
\hline
{\em 其他} & 失败 \\
\hline
\end{DoxyRetVals}
\hypertarget{a00106_ga9631c1d90e0fad04b6ad04ccc5b95808_ga9631c1d90e0fad04b6ad04ccc5b95808}{}\index{stream.\+c@{stream.\+c}!stream\+\_\+push\+\_\+varg@{stream\+\_\+push\+\_\+varg}}
\index{stream\+\_\+push\+\_\+varg@{stream\+\_\+push\+\_\+varg}!stream.\+c@{stream.\+c}}
\subsubsection[{stream\+\_\+push\+\_\+varg}]{\setlength{\rightskip}{0pt plus 5cm}int stream\+\_\+push\+\_\+varg (
\begin{DoxyParamCaption}
\item[{{\bf stream\+\_\+t} $\ast$}]{stream, }
\item[{const char $\ast$}]{format, }
\item[{}]{...}
\end{DoxyParamCaption}
)}\label{a00106_ga9631c1d90e0fad04b6ad04ccc5b95808_ga9631c1d90e0fad04b6ad04ccc5b95808}


向数据流写数据，可变参数字符串 

一次写入的长度不能超过1024 
\begin{DoxyParams}{参数}
{\em stream} & stream\+\_\+t实例 \\
\hline
{\em format} & 字符串格式 \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{返回值}
{\em error\+\_\+ok} & 成功 \\
\hline
{\em 其他} & 失败 \\
\hline
\end{DoxyRetVals}
